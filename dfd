graph TD
    %% Зовнішні сутності
    Client[Клієнти]
    GovCERT[Держ. CERT / Microsoft]
    Analysts[Аналітики / Спеціалісти]
    Regulator[Регулятор / Наглядовий орган]

    %% Процеси
    P1((1. Надходження інцидентів))
    P2((2. Аналіз та оцінка ризиків))
    P3((3. Реагування на інциденти))
    P4((4. Розробка засобів захисту))
    P5((5. Управління спеціалістами))
    P6((6. Бюджетування та фінанси))
    P7((7. Закупівля ліцензій / засобів))
    P8((8. Звітність та аудит))

    %% Сховища даних
    DS1[(Інциденти)]
    DS2[(Ризики / Контрзаходи)]
    DS3[(Бюджет)]
    DS4[(Персонал)]

    %% Потоки даних
    Client -->|Повідомлення про інцидент| P1
    P1 -->|Інформація про інцидент| DS1
    P1 -->|Опис загрози| P2

    P2 -->|Оцінка ризику| DS2
    P2 -->|План реагування| P3
    P2 -->|Потреба в інструментах| P4
    P2 -->|Потреба в ресурсах| P5

    DS1 -->|Деталі інцидентів| P3
    P3 -->|Результат реагування| Client
    P3 -->|Статус інциденту| DS1

    P4 -->|Засоби захисту| GovCERT
    P4 -->|Розроблені рішення| DS2

    Analysts -->|Графік роботи| P5
    P5 -->|Інформація про персонал| DS4
    P5 -->|Зарплата| Analysts

    P1 -->|Фінансова заявка| P6
    P3 -->|Витрати на реагування| P6
    P4 -->|Витрати на розробку| P6
    P5 -->|Витрати на персонал| P6
    P6 -->|Фінансові дані| DS3
    P6 -->|Звітність| Regulator

    P2 -->|Потреба в ліцензіях| P7
    P7 -->|Ліцензії| GovCERT
    P7 -->|Витрати на ресурси| P6

    DS1 -->|Інцидентна аналітика| P8
    DS2 -->|Контрзаходи / ризики| P8
    DS3 -->|Бюджетні показники| P8
    DS4 -->|Дані HR| P8
    P8 -->|Звіт| Client
    P8 -->|Внутрішній аудит| Regulator

    %% Стилі
    classDef process fill:#cce5ff
    classDef datastore fill:#d4edda
    classDef external fill:#fff3cd

    class P1,P2,P3,P4,P5,P6,P7,P8 process
    class DS1,DS2,DS3,DS4 datastore
    class Client,GovCERT,Analysts,Regulator external
